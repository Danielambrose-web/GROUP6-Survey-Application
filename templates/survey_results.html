<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }} | GROUP6 SURVEYS</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Navbar -->
    <header>
        <nav>
            <ul class="sideBar">
                <li onclick="hideSidebar()"><img src="/static/close_24dp_E3E3E3_FILL0_wght400_GRAD0_opsz24.png" alt=""></li>
                <li><a href="{{ url_for('home') }}">HOME</a></li>
                <li><a href="{{ url_for('survey_selection') }}">CREATE SURVEY</a></li>
                <li><a href="{{ url_for('list_surveys') }}">All SURVEY</a></li>
            </ul>
            <div class="logo">
                <H1>GROUP SURVEY APP</H1>
            </div>
            <ul>
                <li class = "menu-btn"><a href="{{ url_for('home') }}">HOME</a></li>
                <li class = "menu-btn"><a href="{{ url_for('survey_selection') }}">CREATE SURVEY</a></li>
                <li class = "menu-btn"><a href="{{ url_for('list_surveys') }}">ALL SURVEY</a></li>
                <li class="toggle active" onclick="showSidebar()"><img src="/static/menu_24dp_E3E3E3_FILL0_wght400_GRAD0_opsz24.png" alt=""></li>
            </ul>
        </nav>
    </header>
    <!-- <header class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <span class="nav-icon"><i class="fas fa-poll"></i></span>
                GROUP6 SURVEY APP
            </div> -->
            <!-- Mobile toggle button -->
            <!-- <button class="nav-toggle" id="nav-toggle">
                &#9776; 
            </button> -->
            <!-- Nav links -->
            <!-- <nav class="nav-links" id="nav-links">
                <a href="{{ url_for('home') }}" class="nav-link">Home</a>
                <a href="{{ url_for('survey_selection') }}" class="nav-link">Create Survey</a>
                <a href="{{ url_for('list_surveys') }}" class="nav-link">All Surveys</a>
            </nav> -->
            <!-- Mobile dropdown menu -->
            <!-- <div class="mobile-dropdown" id="mobile-dropdown">
                <a href="{{ url_for('home') }}" class="dropdown-link">Home</a>
                <a href="{{ url_for('survey_selection') }}" class="dropdown-link">Create Survey</a>
                <a href="{{ url_for('list_surveys') }}" class="dropdown-link">All Surveys</a>
            </div>
        </div>
    </header> -->

    <!-- Main Content -->
    <main class="main-content">
        <section class="survey-section">
            <div class="survey-container">
                <!-- Header -->
                <div class="survey-header">
                    <h1 class="survey-page-title"><i class="fas fa-chart-bar"></i> SURVEY RESULTS</h1>
                    <h2 class="survey-title">{{ survey.title }}</h2>
                    {% if survey.description %}
                    <p class="survey-description-view">{{ survey.description }}</p>
                    {% endif %}
                    <p class="response-count">Total Responses: {{ responses|length }}</p>
                </div>

                <!-- Results Display -->
                {% if responses %}
                    {% for question in questions %}
                    <div class="results-block">
                        <h3 class="question-text">Question {{ question.question_order }}: {{ question.question_text }}</h3>
                        <div class="answers-list">
                            {% for response in responses %}
                                {% if response['question_' + question.id|string] %}
                                <div class="answer-item">
                                    <strong>Response {{ loop.index }}:</strong> {{ response['question_' + question.id|string] }}
                                </div>
                                {% endif %}
                            {% endfor %}
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="empty-state">
                        <i class="fas fa-inbox empty-icon"></i>
                        <h3>No Responses Yet</h3>
                        <p>No one has taken this survey yet. Share it to start collecting responses!</p>
                        <button onclick="sharesurvey('{{ survey.id }}', '{{ survey.title }}')" class="btn btn-success"><!-- There was an error here -->
                            <i class="fas fa-share">Share This Survey</i> 
                        </button>
                    </div>
                {% endif %}

                <!-- Actions -->
                <div class="form-actions">
                    <a href="{{ url_for('list_surveys') }}" class="btn btn-secondary">
                        <i class="fas fa-arrow-left"></i> Back to All Surveys
                    </a>
                    <a href="{{ url_for('take_survey', survey_id=survey.id) }}" class="btn btn-primary">
                        <i class="fas fa-edit"></i> Take This Survey
                    </a>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <p>&copy; 2025 Survey System - GROUP6 SURVEY</p>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="{{ url_for('static', filename='index.js') }}"></script>
    <script>
        function sharesurvey(surveyId, surveyTitle) {
            const surveyUrl = window.location.origin + '/surveys/' + surveyId + '/take';
            const shareText = 'Take this survey: ' + surveyTitle;
            
            const choice = prompt('How would you like to share?\n1. Copy Link\n2. WhatsApp\n3. Facebook\n4. Twitter\n\nEnter number (1-4):');
            
            if (choice === '1') {
                navigator.clipboard.writeText(surveyUrl).then(() => {
                    alert('Survey link copied to clipboard!');
                });
            } else if (choice === '2') {
                window.open('https://wa.me/?text=' + encodeURIComponent(shareText + ' ' + surveyUrl));
            } else if (choice === '3') {
                window.open('https://www.facebook.com/sharer/sharer.php?u=' + encodeURIComponent(surveyUrl));
            } else if (choice === '4') {
                window.open('https://twitter.com/intent/tweet?text=' + encodeURIComponent(shareText) + '&url=' + encodeURIComponent(surveyUrl));
            }
        }
    </script>
</body>
</html>